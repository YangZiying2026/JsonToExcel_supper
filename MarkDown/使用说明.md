# JsonToExcel 成绩分析转换器使用指南

欢迎使用 JsonToExcel 成绩分析转换器！本工具能够将 JSON 格式原始成绩单，一键转换为包含多维分析、自动排名和分班统计的专业 Excel 报表。

## 🚀 核心功能

1.  **一键转换**：无需复杂操作，上传 JSON 文件即可自动生成报表。
2.  **双模式支持**：
    *   **成绩分析模式（默认）**：适用于传统考试或未分科阶段，提供全校/班级总分排名。
    *   **分科统计模式（新高考）**：专为新高考选科设计，支持按“选科组合”进行独立排名和统计。
3.  **多维排名体系**：
    *   **年级总分排名**：包含原始总分、赋分总分及年级排名。
    *   **组合排名**：在分科模式下，自动生成各选科组合（如物化生、史政地）的独立榜单。
    *   **单科排名**：自动生成各学科的年级排名，小四门科目支持展示原始/赋分双成绩。
    *   **班级内部排名**：生成每个班级的独立报表，包含班级排名和年级排名对照。
4.  **智能赋分**：自动识别“政治、地理、化学、生物”等小四门学科并进行新高考赋分计算。
5.  **深度统计**：提供平均分、中位数、最高/最低分及高分/低分名单统计。
6.  **隐私保护**：所有计算均在本地浏览器完成，数据不上传服务器。

## 📂 准备工作

在使用前，请确保您有以下文件：
1.  **原始成绩单 (JSON)**：必须包含学生姓名、班级、考号以及各科成绩。
    *   *限制*：文件大小不超过 **20MB**。
2.  **(可选) 知识库 (Excel)**：用于修正或补充学生信息。
    *   *新功能*：支持在知识库中添加**“组合”**或**“选科”**列，系统将优先读取该列来确定学生的选科情况（如“物化生”）。
    *   *限制*：文件大小不超过 **20MB**。
3.  **(可选) 水印图片**：用于生成带水印的 Excel 报表。
    *   *限制*：图片大小不超过 **10MB**。

## 🛠️ 操作步骤

### 第一步：上传文件
在主界面点击 **“上传 JSON 成绩单”** 区域，选择您的 JSON 文件。
*   *提示*：文件必须是 `.json` 格式。

### 第二步：高级设置 (可选)
点击 **“高级设置”** 展开更多选项：
*   **模式切换**：
    *   **启用分科统计模式**：开启此开关后，系统将按照新高考选科逻辑生成报表，重点展示各组合的独立排名。
    *   *关闭（默认）*：使用传统成绩分析模式，重点展示全年级统一大榜。
*   **上传知识库**：上传包含学生信息（及选科组合）的 Excel 文件。
*   **上传水印**：上传图片作为报表背景。
*   **自定义文件名**：输入您希望保存的文件名。

### 第三步：生成报表
点击底部的 **“立即生成多维分析报表”** 按钮。
*   系统将自动进行数据清洗、语义分析、赋分计算和报表生成。
*   完成后，浏览器会自动下载生成的 `.xlsx` 文件。

## 📊 模式详解

### 1. 成绩分析模式 (默认)
*   **适用场景**：高一上学期、初中或未进行选科分班的考试。
*   **报表特点**：
    *   强调“全年级总分排名”。
    *   所有学生在同一个总榜中竞争。

### 2. 分科统计模式 (新高考)
*   **适用场景**：高一下学期及之后，学生已确定选科组合（如 3+1+2 模式）。
*   **报表特点**：
    *   **组合独立榜单**：额外生成“物化生总分排名”、“史政地总分排名”等分工作表。
    *   **分班表优化**：在班级报表中，明确列出每位学生的选科组合，并展示其在所属组合内的排名。
    *   **组合推断**：系统会优先从知识库读取组合信息；如果未提供，会自动根据学生是否有有效成绩来推断其组合。

## 💡 常见问题

**Q: 为什么显示“无效的 JSON 文件”？**
A: 请确保 JSON 文件内容是一个对象数组，且包含必要的字段（如姓名、班级）。

**Q: 如何让系统识别学生的选科组合？**
A: 推荐在“知识库 Excel”中增加一列名为“组合”或“选科”，填入如“物化生”、“史地政”等内容。系统也可以根据学生是否有分数自动推断，但显式指定最为准确。

**Q: 生成的 Excel 打不开？**
A: 请确保使用 Microsoft Excel 2016+ 或 WPS Office 打开文件。
